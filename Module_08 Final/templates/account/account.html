{% load django_bootstrap5 %}
<!DOCTYPE html>
<html>
	<head>
		<title>ðŸ’« d09: Authentication</title>
		{% bootstrap_css %}
		{% bootstrap_javascript %}
	</head>
	<body class="bg-dark">
		<div id="notification-container" class="position-fixed top-0 end-0 p-3" style="z-index: 1050;"></div>
		<div class="container">
			<div class="row justify-content-center mt-5">
				<div class="col-md-6 col-lg-4">
					<div class="card border-secondary">
						<div class="card-body bg-secondary">
							<div id="auth-forms-container" {% if user.is_authenticated %}class="d-none"{% endif %}>
								<ul class="nav nav-tabs nav-fill mb-3">
									<li class="nav-item w-50">
										<button class="nav-link active bg-primary text-white w-100" id="login-tab" data-bs-toggle="tab" 
												data-bs-target="#login-panel" type="button" role="tab">
											Login
										</button>
									</li>
									<li class="nav-item w-50">
										<button class="nav-link text-white w-100" id="register-tab" data-bs-toggle="tab" 
												data-bs-target="#register-panel" type="button" role="tab">
											Register
										</button>
									</li>
								</ul>
								<div class="tab-content">
									<div class="tab-pane fade show active" id="login-panel" role="tabpanel">
										<form id="login-form" class="needs-validation" novalidate>
											{% csrf_token %}
											<div class="mb-3">
												<input type="text" class="form-control" id="username" 
													name="username" placeholder="Username" required>
												<div class="text-light small mt-1" id="username-status">Enter your username</div>
												<div class="invalid-feedback" id="username-error"></div>
											</div>
											<div class="mb-3">
												<input type="password" class="form-control" id="password" 
													name="password" placeholder="Password" required>
												<div class="text-light small mt-1" id="password-status">Enter your password</div>
												<div class="invalid-feedback" id="password-error"></div>
											</div>
											<div class="row g-2">
												<div class="col-6">
													<button type="submit" class="btn btn-success w-100 fw-bold">Login</button>
												</div>
												<div class="col-6">
													<button type="button" class="btn btn-warning w-100 fw-bold" onclick="FormModule.clearForm('login-form')">Clear</button>
												</div>
											</div>
										</form>
									</div>
									<div class="tab-pane fade" id="register-panel" role="tabpanel">
										<form id="register-form" class="needs-validation" novalidate>
											{% csrf_token %}
											<div class="mb-3">
												<input type="text" class="form-control" id="reg-username" 
													name="username" placeholder="Choose username" required>
												<div class="text-light small mt-1" id="reg-username-status">At least 3 characters</div>
												<div class="invalid-feedback" id="reg-username-error"></div>
											</div>
											<div class="mb-3">
												<input type="password" class="form-control" id="reg-password" 
													name="password" placeholder="Choose password" required>
												<div class="text-light small mt-1" id="reg-password-status">At least 6 characters</div>
												<div class="invalid-feedback" id="reg-password-error"></div>
											</div>
											<div class="mb-3">
												<input type="password" class="form-control" id="reg-confirm-password" 
													name="confirm_password" placeholder="Confirm password" required>
												<div class="text-light small mt-1" id="reg-confirm-password-status">Repeat your password</div>
												<div class="invalid-feedback" id="reg-confirm-password-error"></div>
											</div>
											<div class="row g-2">
												<div class="col-6">
													<button type="submit" class="btn btn-success w-100 fw-bold">Register</button>
												</div>
												<div class="col-6">
													<button type="button" class="btn btn-warning w-100 fw-bold" onclick="FormModule.clearForm('register-form')">Clear</button>
												</div>
											</div>
										</form>
									</div>
								</div>
							</div>
							<div id="user-info" class="text-center {% if not user.is_authenticated %}d-none{% endif %}">
								<h4 class="mb-3 text-white">Welcome!</h4>
								<p class="mb-3 text-white">Logged as <span id="username-display" class="text-info fw-bold">{{ user.username }}</span></p>
								<form method="post" action="/logout/">
									<button type="submit" id="logout-btn" class="btn btn-danger fw-bold">Logout</button>
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
		<script src="/scripts/auth.js"></script>
	</body>
</html>